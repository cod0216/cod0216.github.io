---
title: GitHub WebRTC란 - 연결 방식(Mesh, SFU, MCU)
date: 2025-01-26 00:00:00 +0900
categories: [Infra, WebRTC]
tags: [Project, WebRTC, Infra]
toc: true
comments: true
---


# 01. WebRTC 아키텍처

WebRTC는 크게 3가지로 나뉜다.

1. Mesh(Peer-to-Peer)
2. SFU(Selective Forwarding)
3. MCU(Multipoint Control)

위 3가지는 데이터 처리를 어디서 하는지, 서버를 거치는지에 따라 달라진다.

# 02. Mesh(Peer-to-Peer)

- 모든 참여자가 모든 참여자와 직접(P2P) 연결하는 구조
- 즉 서버가 미디어를 중계하지 않고 각 브라우저가 서로에게 스트림을 직접 전송한다.
- 클라이언트의 부하가 참여 인원이 많아질 수록 폭증하게 된다.

![image.png](/assets/img/connect-WebRTC/1.png)

# 03. SFU(Selective Forwarding Unit)

- 각 클라이언트가 서버로 스트림을 1개만 보내고 서버가 여러 참가자들에게 전달하는 구조
- 서버는 중계 역할만 한다.
- 클라이언트는 미디어 데이터를 받고 클라이언트에서 해당 데이터를 Layout 기준으로 가공한다.
- Mesh 방식에 비해 클라이언트의 부하가 크게 줄어들고 서버의 부하가 올라간다.
    - 단, 서버는 전달만 하기에 크게 증가하진 않는다.

![image.png](/assets/img/connect-WebRTC/2.png)

# 04. MCU(Multipoint Control Unit)

- 모든 참가자의 미디어를 서버가 직접 수신해 해당 데이터를 디코딩 후 가공하고 다시 하나의 스트림으로 재인코딩하여 클라이언트에게 보내는 구조
- 클라이언트는 서버에서 보내는 데이터만 받기만 하면 된다.
- 서버는 미디어 화질, 레이아웃등을 결정한다.
- 이 외 다양한 기능들을 서버에서 처리해야 하기에 서버의 부하가 급증하고 지연 현상이 발생한다.
- 주로 클라이언트의 사양이 낮을때 사용한다.

![image.png](/assets/img/connect-WebRTC/3.png)

# 05. 정리

| **구분** | **Mesh (P2P)** | **SFU (Selective Forwarding)** | **MCU (Multipoint Control)** |
| --- | --- | --- | --- |
| **핵심 개념** | **직접 연결 (N:N)** | **중앙 배달 (복사)** | **중앙 합성 (믹싱)** |
| **데이터 흐름** | 클라이언트 ↔ 클라이언트 | 클라이언트 → 서버 → 클라이언트 | 클라이언트 → 서버 → 클라이언트 |
| **서버의 역할** | 없음 (시그널링만 수행) | 미디어 패킷 **복사 및 전달** | 미디어 **디코딩 + 합성 + 인코딩** |
| **클라이언트 연산** | 개별 스트림 모두 디코딩 | 개별 스트림 디코딩 + **레이아웃 배치** | 단순 재생 (서버가 배치 완료) |
| **서버 부하** | 거의 없음 | 낮음 ~ 중간 (네트워크 I/O 위주) | **매우 높음 (CPU/GPU 위주)** |
| **지연 시간** | 가장 짧음 | 짧음 | 보통 (합성 연산 시간 추가) |
| **주요 용도** | 1:1 통화, 소규모(3~4인) | 대규모 화상회의 (Zoom 등) | 저사양 기기 지원, 방송 송출 |
